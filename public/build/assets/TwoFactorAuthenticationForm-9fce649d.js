import{d as _,_ as y,o as t,c as n,b as e,s as T,e as d,m as s,i as a,t as h,w as f,v as A,k as p,E as R,x as g,l as c,h as b,f as u,F as B,r as E}from"./app-5a739dd9.js";import{D,A as M}from"./DialogModal-48696bc6.js";import{B as v}from"./Button-835ef4ee.js";import{I as q}from"./Input-8812850b.js";import{I as L}from"./InputError-8e109f03.js";import{S as C}from"./SecondaryButton-ae55756a.js";import{D as V}from"./DangerButton-d1505699.js";import"./Modal-94d7f363.js";const I=_({emits:["confirmed"],props:{title:{default:"Confirm Password"},content:{default:"For your security, please confirm your password to continue."},button:{default:"Confirm"}},components:{Button:v,DialogModal:D,Input:q,InputError:L,SecondaryButton:C},data(){return{modal:null,form:this.$inertia.form({password:"",error:""},{bag:"confirmPassword"})}},methods:{startConfirmingPassword(){this.form.error="";let o=document.querySelector("#confirmingPasswordModal");this.modal=new bootstrap.Modal(o),axios.get(route("password.confirmation")).then(r=>{r.data.confirmed?this.$emit("confirmed"):(this.modal.toggle(),this.form.password="",setTimeout(()=>{this.$refs.password.focus()},250))})},confirmPassword(){this.form.processing=!0,axios.post(route("password.confirm"),{password:this.form.password}).then(o=>{this.bootstrap.modal("hide"),this.form.password="",this.form.error="",this.form.processing=!1,this.$nextTick(()=>this.$emit("confirmed"))}).catch(o=>{this.form.processing=!1,this.form.error=o.response.data.errors.password[0]})}}}),N={class:"mt-4"},Q=["disabled"],Y={class:"spinner-border spinner-border-sm",role:"status"},H=e("span",{class:"visually-hidden"},"Loading...",-1),K=[H];function z(o,r,$,k,F,P){const l=c("input-error"),m=c("secondary-button"),w=c("dialog-modal");return t(),n("span",null,[e("span",{onClick:r[0]||(r[0]=(...i)=>o.startConfirmingPassword&&o.startConfirmingPassword(...i))},[T(o.$slots,"default")]),d(w,{id:"confirmingPasswordModal"},{title:s(()=>[a(h(o.title),1)]),content:s(()=>[a(h(o.content)+" ",1),e("div",N,[f(e("input",{type:"password",placeholder:"Password",ref:"password","onUpdate:modelValue":r[1]||(r[1]=i=>o.form.password=i),class:p({"is-invalid":o.form.error}),onKeyup:r[2]||(r[2]=R((...i)=>o.confirmPassword&&o.confirmPassword(...i),["enter"]))},null,34),[[A,o.form.password]]),d(l,{message:o.form.error},null,8,["message"])])]),footer:s(()=>[d(m,{"data-bs-dismiss":"modal"},{default:s(()=>[a(" Cancel ")]),_:1}),e("button",{class:p(["ms-2",{"text-black-50":o.form.processing}]),onClick:r[3]||(r[3]=(...i)=>o.confirmPassword&&o.confirmPassword(...i)),disabled:o.form.processing},[f(e("div",Y,K,512),[[g,o.form.processing]]),a(" "+h(o.button),1)],10,Q)]),_:1})])}const G=y(I,[["render",z]]),U=_({components:{ActionSection:M,Button:v,ConfirmsPassword:G,DangerButton:V,SecondaryButton:C},data(){return{enabling:!1,disabling:!1,qrCode:null,recoveryCodes:[]}},methods:{enableTwoFactorAuthentication(){this.enabling=!0,this.$inertia.post("/user/two-factor-authentication",{},{preserveScroll:!0,onSuccess:()=>Promise.all([this.showQrCode(),this.showRecoveryCodes()]),onFinish:()=>this.enabling=!1})},showQrCode(){return axios.get("/user/two-factor-qr-code").then(o=>{this.qrCode=o.data.svg})},showRecoveryCodes(){return axios.get("/user/two-factor-recovery-codes").then(o=>{this.recoveryCodes=o.data})},regenerateRecoveryCodes(){axios.post("/user/two-factor-recovery-codes").then(o=>{this.showRecoveryCodes()})},disableTwoFactorAuthentication(){this.disabling=!0,this.$inertia.delete("/user/two-factor-authentication",{preserveScroll:!0,onSuccess:()=>this.disabling=!1})}},computed:{twoFactorEnabled(){return!this.enabling&&this.$page.props.user.two_factor_enabled}}}),W={key:0,class:"h5 font-weight-bold"},j={key:1,class:"h5 font-weight-bold"},J=e("div",{class:"mt-3"},[e("p",null," When two factor authentication is enabled, you will be prompted for a secure, random token during authentication. You may retrieve this token from your phone's Google Authenticator application. ")],-1),O={key:2},X={key:0},Z=e("div",{class:"mt-3"},[e("p",null," Two factor authentication is now enabled. Scan the following QR code using your phone's authenticator application. ")],-1),x=["innerHTML"],oo={key:1},eo=e("div",{class:"mt-3"},[e("p",null," Store these recovery codes in a secure password manager. They can be used to recover access to your account if your two factor authentication device is lost. ")],-1),so={class:"w-75 bg-light rounded p-3"},to={class:"mt-3"},ro={key:0},no=["disabled"],ao={class:"spinner-border spinner-border-sm",role:"status"},io=e("span",{class:"visually-hidden"},"Loading...",-1),co=[io],lo={key:1},uo={class:"spinner-border spinner-border-sm",role:"status"},mo=e("span",{class:"visually-hidden"},"Loading...",-1),ho=[mo];function fo(o,r,$,k,F,P){const l=c("confirms-password"),m=c("secondary-button"),w=c("danger-button"),i=c("action-section");return t(),b(i,null,{title:s(()=>[a(" Two Factor Authentication ")]),description:s(()=>[a(" Add additional security to your account using two factor authentication. ")]),content:s(()=>[o.twoFactorEnabled?(t(),n("h3",W," You have enabled two factor authentication. ")):(t(),n("h3",j," You have not enabled two factor authentication. ")),J,o.twoFactorEnabled?(t(),n("div",O,[o.qrCode?(t(),n("div",X,[Z,e("div",{class:"mt-3",innerHTML:o.qrCode},null,8,x)])):u("",!0),o.recoveryCodes.length>0?(t(),n("div",oo,[eo,e("div",so,[(t(!0),n(B,null,E(o.recoveryCodes,S=>(t(),n("div",null,h(S),1))),256))])])):u("",!0)])):u("",!0),e("div",to,[o.twoFactorEnabled?(t(),n("div",lo,[d(l,{onConfirmed:o.regenerateRecoveryCodes},{default:s(()=>[o.recoveryCodes.length>0?(t(),b(m,{key:0,class:"me-3"},{default:s(()=>[a(" Regenerate Recovery Codes ")]),_:1})):u("",!0)]),_:1},8,["onConfirmed"]),d(l,{onConfirmed:o.showRecoveryCodes},{default:s(()=>[o.recoveryCodes.length==0?(t(),b(m,{key:0,class:"me-3"},{default:s(()=>[a(" Show Recovery Codes ")]),_:1})):u("",!0)]),_:1},8,["onConfirmed"]),d(l,{onConfirmed:o.disableTwoFactorAuthentication},{default:s(()=>[d(w,{class:p({"text-white-50":o.disabling}),disabled:o.disabling},{default:s(()=>[f(e("div",uo,ho,512),[[g,o.form.processing]]),a(" Disable ")]),_:1},8,["class","disabled"])]),_:1},8,["onConfirmed"])])):(t(),n("div",ro,[d(l,{onConfirmed:o.enableTwoFactorAuthentication},{default:s(()=>[e("button",{type:"button",class:p({"text-white-50":o.enabling}),disabled:o.enabling},[f(e("div",ao,co,512),[[g,o.enabling]]),a(" Enable ")],10,no)]),_:1},8,["onConfirmed"])]))])]),_:1})}const $o=y(U,[["render",fo]]);export{$o as default};
